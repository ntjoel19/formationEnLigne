<!--
  Generated template for the UserManagerPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar color="twitter" hideBackButton="true">
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>Gestion des utilisateurs</ion-title>
  </ion-navbar>
</ion-header>


<ion-content class="card-background-page">
    <ion-list class="list-card" class="find-friends-list" padding-horizontal no-margin>
      <ion-searchbar placeholder="filtrer" class="head-search"></ion-searchbar>
      <div *ngIf="testOffline">
        <ion-item *ngFor="let item of userList | async;let i=index" no-line>
            <ion-avatar item-start>
              <img *ngIf='item.avatar!==undefined' src="{{item.avatar.url}}">
              <img *ngIf='item.avatar===undefined' src="assets/img/user-img.png">
            </ion-avatar>
            <ion-label  (click)="userDetails('userDetail',item)">
              <h2 no-margin text-uppercase>{{item.firstname}} {{item.name}} <small>({{i}})</small></h2>
              <h3 text-uppercase>{{item.status}}</h3>
              <p>{{item.email}} {{item.phone}}</p>
              <span *ngFor="let course of item.courses;let j=index">
                {{course.subtitle}}
                <button color="danger" *ngIf="!course.authorisation" (click)="allowCourse(item,j,0)" ion-button icon-start clear small>
                  <ion-icon name="text"></ion-icon>
                  <div color="danger">Allow</div>
                </button>
                <button color="danger" *ngIf="course.authorisation" (click)="allowCourse(item,j,1)" ion-button icon-start clear small>
                  <ion-icon name="text"></ion-icon>
                  <div>Reject</div>
                </button>
              </span>
            </ion-label>
            
            <button color="twitter" *ngIf="!open[i]" ion-button clear (click)="moreOptions(i)" item-end><ion-icon name='ios-more'></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]" ion-button clear item-end><ion-icon name="md-information-circle" ></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]" ion-button clear item-end><ion-icon name="md-brush" ></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]  && !item.accepted" ion-button clear (click)="acceptUser(item)" item-end><ion-icon name="md-checkbox-outline"></ion-icon></button>
            <button color="grayColor" *ngIf="item.accepted && open[i]" ion-button clear (click)="acceptUser(item)" item-end><ion-icon name="md-close-circle" ></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]" ion-button clear (click)="delUser(item)" item-end><ion-icon name="md-trash" ></ion-icon></button>
            <button color="twitter" *ngIf="open[i]" ion-button clear (click)="moreOptions(i)" item-end><ion-icon name='ios-arrow-back'></ion-icon></button>
            
        </ion-item>
      </div>
      <div *ngIf="!testOffline">
        <ion-item *ngFor="let item of userListOffline;let i=index" no-line>
            <ion-avatar item-start>
              <img *ngIf='item.avatar!==undefined' src="{{item.avatar.url}}">
              <img *ngIf='item.avatar===undefined' src="assets/img/user-img.png">
            </ion-avatar>
            <ion-label  (click)="userDetails('userDetail',item)">
              <h2 no-margin text-uppercase>{{item.firstname}} {{item.name}}</h2>
              <h3 text-uppercase>{{item.status}}</h3>
              <p>{{item.email}} {{item.phone}}</p>
              <span *ngFor="let course of item.courses;let j=index">
                {{course.subtitle}}
                <button color="danger" *ngIf="!course.authorisation" (click)="allowCourse(item,j,0)" ion-button icon-start clear small>
                  <ion-icon name="text"></ion-icon>
                  <div color="danger">Allow</div>
                </button>
                <button color="danger" *ngIf="course.authorisation" (click)="allowCourse(item,j,1)" ion-button icon-start clear small>
                  <ion-icon name="text"></ion-icon>
                  <div>Reject</div>
                </button>
              </span>
            </ion-label>
            
            <button color="twitter" *ngIf="!open[i]" ion-button clear (click)="moreOptions(i)" item-end><ion-icon name='ios-more'></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]" ion-button clear item-end><ion-icon name="md-information-circle" ></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]" ion-button clear item-end><ion-icon name="md-brush" ></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]  && !item.accepted" ion-button clear (click)="acceptUser(item)" item-end><ion-icon name="md-checkbox-outline"></ion-icon></button>
            <button color="grayColor" *ngIf="item.accepted && open[i]" ion-button clear (click)="acceptUser(item)" item-end><ion-icon name="md-close-circle" ></ion-icon></button>
            <button color="grayColor" *ngIf="open[i]" ion-button clear (click)="delUser(item)" item-end><ion-icon name="md-trash" ></ion-icon></button>
            <button color="twitter" *ngIf="open[i]" ion-button clear (click)="moreOptions(i)" item-end><ion-icon name='ios-arrow-back'></ion-icon></button>
            
        </ion-item>
      </div>
    </ion-list>
</ion-content>